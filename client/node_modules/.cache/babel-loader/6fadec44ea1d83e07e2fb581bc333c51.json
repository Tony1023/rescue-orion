{"ast":null,"code":"var _jsxFileName = \"/Users/raz/Desktop/rescue-orion/client/src/room/GameBoard.tsx\";\nimport React, { useState, useLayoutEffect, useEffect } from 'react';\nimport ButtonGroup from './ButtonGroup';\nimport SpaceStation from './SpaceStation';\nimport { GameStatus } from '../metadata/types';\nimport styled from 'styled-components';\nimport { locationData, spaceStationData } from '../metadata';\nimport * as IDs from '../metadata/agent-ids';\nimport MessageModal from './modal/MessageModal';\nimport ResourcePanel from './ResourcePanel';\nimport RebalanceResourceModal from './modal/RebalanceResourceModal';\nimport EndGameModal from './modal/EndGameModal';\nimport ConfirmMoveModal from './modal/ConfirmMoveModal';\nimport { useSelector } from './redux-hook-adapters';\nimport Clock from './Clock';\nconst GEMINI_LEFT_OFFSET = 45;\nconst GEMINI_TOP_OFFSET = 50;\nconst GameBoard = styled.div`\n  background-image: url(${`${process.env.PUBLIC_URL}/game_map.jpg`});\n  height: 810px;\n  width: 1440px;\n  background-size: contain;\n  position: relative;\n  margin: 0 auto;\n`;\nconst GeminiShip = styled.div`\n  width: 80px;\n  height: 80px;\n  display: block;\n  position: absolute;\n  background-size: contain;\n`;\nconst Gemini1 = styled(GeminiShip)`\n  background-image: url(${`${process.env.PUBLIC_URL}/Gemini1.png`});\n  top: ${props => `${props.position.top - GEMINI_TOP_OFFSET}px`};\n  left: ${props => `${props.position.left - GEMINI_LEFT_OFFSET}px`};\n`;\nconst Gemini2 = styled(GeminiShip)`\n  background-image: url(${`${process.env.PUBLIC_URL}/Gemini2.png`});\n  top: ${props => `${props.position.top - GEMINI_TOP_OFFSET}px`};\n  left: ${props => `${props.position.left - GEMINI_LEFT_OFFSET}px`};\n`;\nconst Gemini12 = styled(GeminiShip)`\n  background-image: url(${`${process.env.PUBLIC_URL}/Gemini12.png`});\n  top: ${props => `${props.position.top - GEMINI_TOP_OFFSET}px`};\n  left: ${props => `${props.position.left - GEMINI_LEFT_OFFSET}px`};\n`;\nconst ActionButton = styled.div`\n  width: 120px;\n  height: 40px;\n  position: absolute;\n  background-size: cover;\n  cursor: pointer;\n`;\nconst ConfirmMoveButton = styled(ActionButton)`\n  background-image: url(${`${process.env.PUBLIC_URL}/confirm_move.png`});\n  top: 10px;\n  left: 30px;\n  cursor: ${props => !props.noMove ? 'cursor' : `not-allowed`};\n  :hover {\n    background-image: ${props => props.noMove ? `url(${process.env.PUBLIC_URL}/confirm_move.png)` : `url(${process.env.PUBLIC_URL}/confirm_move_hover.png)`};\n  }\n`;\nconst MoveResourceButton = styled(ActionButton)`\n  background-image: url(${`${process.env.PUBLIC_URL}/move_resources.png`});\n  top: 580px;\n  left: 100px;\n  cursor: ${props => !props.disabled ? 'cursor' : `not-allowed`};\n  :hover {\n    background-image: ${props => !props.disabled ? `url(${process.env.PUBLIC_URL}/move_resources_hover.png)` : `url(${process.env.PUBLIC_URL}/move_resources.png)`};\n  }\n`;\nconst TerminateGameButton = styled(ActionButton)`\n  background-image: url(${`${process.env.PUBLIC_URL}/abort_mission.png`});\n  top: 55px;\n  left: 30px;\n  :hover {\n    background-image: url(${`${process.env.PUBLIC_URL}/abort_mission_hover.png`});\n  }\n`;\nexport default function () {\n  const gameState = useSelector(state => state);\n  console.log(gameState);\n  const [gemini1NextMove, setGemini1NextMove] = useState();\n  const [gemini2NextMove, setGemini2NextMove] = useState();\n  const [messages, setMessages] = useState([]);\n  const [showRebalanceModal, setShowRebalanceModal] = useState(false);\n  const [showConfirmMoveModal, setShowConfirmMoveModal] = useState(false);\n  useLayoutEffect(() => {\n    setGemini1NextMove(undefined);\n    setGemini2NextMove(undefined);\n\n    if (gameState.time > 30) {// setGameOver(true);\n    }\n  }, [gameState.time]);\n  useEffect(() => {\n    setMessages(messages.concat(gameState.messages));\n  }, [gameState.messages]);\n  const selectedMove = gemini1NextMove && gemini2NextMove;\n  const gemini_1 = gameState.spaceships[IDs.GEMINI_1];\n  const gemini_2 = gameState.spaceships[IDs.GEMINI_2];\n  const gemini1CurrentLocation = gemini_1.location;\n  const gemini2CurrentLocation = gemini_2.location;\n  const gemini1Location = gemini1NextMove !== null && gemini1NextMove !== void 0 ? gemini1NextMove : gemini1CurrentLocation;\n  const gemini2Location = gemini2NextMove !== null && gemini2NextMove !== void 0 ? gemini2NextMove : gemini2CurrentLocation;\n  const position1 = locationData[gemini1Location].pixelPosition;\n  const position2 = locationData[gemini2Location].pixelPosition;\n  const canRebalanceResource = gemini1CurrentLocation === gemini2CurrentLocation && gemini_1.isInTimePortal === gemini_2.isInTimePortal;\n\n  function popMessageModal() {\n    const remainingMessages = messages.slice(0);\n    remainingMessages.pop();\n    setMessages(remainingMessages);\n  }\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(GameBoard, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(ConfirmMoveButton, {\n    noMove: !selectedMove,\n    onClick: () => {\n      if (selectedMove) {\n        setShowConfirmMoveModal(true);\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(MoveResourceButton, {\n    disabled: !canRebalanceResource,\n    onClick: () => {\n      if (canRebalanceResource) {\n        setShowRebalanceModal(true);\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(TerminateGameButton, {\n    onClick: () => {} // () => setGameOver(true)\n    ,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 7\n    }\n  }), gemini1Location === gemini2Location ? /*#__PURE__*/React.createElement(Gemini12, {\n    position: position1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 9\n    }\n  }) : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Gemini1, {\n    position: position1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Gemini2, {\n    position: position2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 11\n    }\n  })), Object.entries(gameState.nextMoves).map((location, index) => {\n    return /*#__PURE__*/React.createElement(ButtonGroup, {\n      key: index,\n      id: location[0],\n      gemini1NextMove: gemini1NextMove === location[0],\n      gemini2NextMove: gemini2NextMove === location[0],\n      setGemini1NextMove: setGemini1NextMove,\n      setGemini2NextMove: setGemini2NextMove,\n      shipReachability: location[1],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 13\n      }\n    });\n  }), Object.entries(spaceStationData).map((spaceStation, index) => {\n    return /*#__PURE__*/React.createElement(SpaceStation, {\n      key: index,\n      id: spaceStation[0],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 18\n      }\n    });\n  }), messages.map((message, index) => {\n    return /*#__PURE__*/React.createElement(MessageModal, {\n      key: index,\n      message: message,\n      onClose: popMessageModal,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 18\n      }\n    });\n  }), showRebalanceModal ? /*#__PURE__*/React.createElement(RebalanceResourceModal, {\n    onClose: () => setShowRebalanceModal(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 9\n    }\n  }) : /*#__PURE__*/React.createElement(React.Fragment, null), gameState.status === GameStatus.MissionFailed ? /*#__PURE__*/React.createElement(EndGameModal, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 9\n    }\n  }) : /*#__PURE__*/React.createElement(React.Fragment, null), showConfirmMoveModal ? /*#__PURE__*/React.createElement(ConfirmMoveModal, {\n    gemini1NextMove: gemini1Location,\n    gemini2NextMove: gemini2Location,\n    onClose: () => {\n      setShowConfirmMoveModal(false);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 9\n    }\n  }) : /*#__PURE__*/React.createElement(React.Fragment, null), /*#__PURE__*/React.createElement(ResourcePanel, {\n    gemini1: gameState.spaceships[IDs.GEMINI_1],\n    gemini2: gameState.spaceships[IDs.GEMINI_2],\n    time: gameState.time,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Clock, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 7\n    }\n  })));\n}","map":{"version":3,"sources":["/Users/raz/Desktop/rescue-orion/client/src/room/GameBoard.tsx"],"names":["React","useState","useLayoutEffect","useEffect","ButtonGroup","SpaceStation","GameStatus","styled","locationData","spaceStationData","IDs","MessageModal","ResourcePanel","RebalanceResourceModal","EndGameModal","ConfirmMoveModal","useSelector","Clock","GEMINI_LEFT_OFFSET","GEMINI_TOP_OFFSET","GameBoard","div","process","env","PUBLIC_URL","GeminiShip","Gemini1","props","position","top","left","Gemini2","Gemini12","ActionButton","ConfirmMoveButton","noMove","MoveResourceButton","disabled","TerminateGameButton","gameState","state","console","log","gemini1NextMove","setGemini1NextMove","gemini2NextMove","setGemini2NextMove","messages","setMessages","showRebalanceModal","setShowRebalanceModal","showConfirmMoveModal","setShowConfirmMoveModal","undefined","time","concat","selectedMove","gemini_1","spaceships","GEMINI_1","gemini_2","GEMINI_2","gemini1CurrentLocation","location","gemini2CurrentLocation","gemini1Location","gemini2Location","position1","pixelPosition","position2","canRebalanceResource","isInTimePortal","popMessageModal","remainingMessages","slice","pop","Object","entries","nextMoves","map","index","spaceStation","message","status","MissionFailed"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,eAA1B,EAA2CC,SAA3C,QAA4D,OAA5D;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,OAAOC,YAAP,MAAyB,gBAAzB;AACA,SAAoBC,UAApB,QAA+C,mBAA/C;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AACA,SAASC,YAAT,EAAuBC,gBAAvB,QAA+C,aAA/C;AACA,OAAO,KAAKC,GAAZ,MAAqB,uBAArB;AACA,OAAOC,YAAP,MAAyB,sBAAzB;AAEA,OAAOC,aAAP,MAA0B,iBAA1B;AACA,OAAOC,sBAAP,MAAmC,gCAAnC;AACA,OAAOC,YAAP,MAAyB,sBAAzB;AACA,OAAOC,gBAAP,MAA6B,0BAA7B;AACA,SAASC,WAAT,QAA4B,uBAA5B;AACA,OAAOC,KAAP,MAAkB,SAAlB;AAEA,MAAMC,kBAAkB,GAAG,EAA3B;AACA,MAAMC,iBAAiB,GAAG,EAA1B;AAEA,MAAMC,SAAS,GAAGb,MAAM,CAACc,GAAI;0BACF,GAAEC,OAAO,CAACC,GAAR,CAAYC,UAAW,eAAe;;;;;;CADnE;AASA,MAAMC,UAAU,GAAGlB,MAAM,CAACc,GAAI;;;;;;CAA9B;AAOA,MAAMK,OAAO,GAAGnB,MAAM,CAACkB,UAAD,CAAa;0BACR,GAAEH,OAAO,CAACC,GAAR,CAAYC,UAAW,cAAc;SACxDG,KAAD,IAAyC,GAAEA,KAAK,CAACC,QAAN,CAAeC,GAAf,GAAqBV,iBAAkB,IAAI;UACpFQ,KAAD,IAAyC,GAAEA,KAAK,CAACC,QAAN,CAAeE,IAAf,GAAsBZ,kBAAmB,IAAI;CAHlG;AAKA,MAAMa,OAAO,GAAGxB,MAAM,CAACkB,UAAD,CAAa;0BACR,GAAEH,OAAO,CAACC,GAAR,CAAYC,UAAW,cAAc;SACxDG,KAAD,IAAyC,GAAEA,KAAK,CAACC,QAAN,CAAeC,GAAf,GAAqBV,iBAAkB,IAAI;UACpFQ,KAAD,IAAyC,GAAEA,KAAK,CAACC,QAAN,CAAeE,IAAf,GAAsBZ,kBAAmB,IAAI;CAHlG;AAKA,MAAMc,QAAQ,GAAGzB,MAAM,CAACkB,UAAD,CAAa;0BACT,GAAEH,OAAO,CAACC,GAAR,CAAYC,UAAW,eAAe;SACzDG,KAAD,IAAyC,GAAEA,KAAK,CAACC,QAAN,CAAeC,GAAf,GAAqBV,iBAAkB,IAAI;UACpFQ,KAAD,IAAyC,GAAEA,KAAK,CAACC,QAAN,CAAeE,IAAf,GAAsBZ,kBAAmB,IAAI;CAHlG;AAMA,MAAMe,YAAY,GAAG1B,MAAM,CAACc,GAAI;;;;;;CAAhC;AAQA,MAAMa,iBAAiB,GAAG3B,MAAM,CAAC0B,YAAD,CAAe;0BACpB,GAAEX,OAAO,CAACC,GAAR,CAAYC,UAAW,mBAAmB;;;YAG1DG,KAAD,IAAgC,CAACA,KAAK,CAACQ,MAAP,GAAgB,QAAhB,GAA2B,aAAa;;wBAE3DR,KAAD,IAAgCA,KAAK,CAACQ,MAAN,GAAgB,OAAMb,OAAO,CAACC,GAAR,CAAYC,UAAW,oBAA7C,GAAmE,OAAMF,OAAO,CAACC,GAAR,CAAYC,UAAW,0BAA0B;;CANlL;AAUA,MAAMY,kBAAkB,GAAG7B,MAAM,CAAC0B,YAAD,CAAe;0BACrB,GAAEX,OAAO,CAACC,GAAR,CAAYC,UAAW,qBAAqB;;;YAG5DG,KAAD,IAAkC,CAACA,KAAK,CAACU,QAAP,GAAkB,QAAlB,GAA6B,aAAa;;wBAE/DV,KAAD,IAAkC,CAACA,KAAK,CAACU,QAAP,GAAmB,OAAMf,OAAO,CAACC,GAAR,CAAYC,UAAW,4BAAhD,GAA8E,OAAMF,OAAO,CAACC,GAAR,CAAYC,UAAW,sBAAsB;;CAN3L;AAUA,MAAMc,mBAAmB,GAAG/B,MAAM,CAAC0B,YAAD,CAAe;0BACtB,GAAEX,OAAO,CAACC,GAAR,CAAYC,UAAW,oBAAoB;;;;4BAI3C,GAAEF,OAAO,CAACC,GAAR,CAAYC,UAAW,0BAA0B;;CALhF;AASA,eAAe,YAAW;AACxB,QAAMe,SAAS,GAAGvB,WAAW,CAAEwB,KAAD,IAAsBA,KAAvB,CAA7B;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYH,SAAZ;AAEA,QAAM,CAACI,eAAD,EAAkBC,kBAAlB,IAAwC3C,QAAQ,EAAtD;AACA,QAAM,CAAC4C,eAAD,EAAkBC,kBAAlB,IAAwC7C,QAAQ,EAAtD;AACA,QAAM,CAAC8C,QAAD,EAAWC,WAAX,IAA0B/C,QAAQ,CAAY,EAAZ,CAAxC;AACA,QAAM,CAACgD,kBAAD,EAAqBC,qBAArB,IAA8CjD,QAAQ,CAAC,KAAD,CAA5D;AACA,QAAM,CAACkD,oBAAD,EAAuBC,uBAAvB,IAAkDnD,QAAQ,CAAC,KAAD,CAAhE;AAEAC,EAAAA,eAAe,CAAC,MAAM;AACpB0C,IAAAA,kBAAkB,CAACS,SAAD,CAAlB;AACAP,IAAAA,kBAAkB,CAACO,SAAD,CAAlB;;AACA,QAAId,SAAS,CAACe,IAAV,GAAiB,EAArB,EAAyB,CACvB;AACD;AACF,GANc,EAMZ,CAACf,SAAS,CAACe,IAAX,CANY,CAAf;AAQAnD,EAAAA,SAAS,CAAC,MAAM;AACd6C,IAAAA,WAAW,CAACD,QAAQ,CAACQ,MAAT,CAAgBhB,SAAS,CAACQ,QAA1B,CAAD,CAAX;AACD,GAFQ,EAEN,CAACR,SAAS,CAACQ,QAAX,CAFM,CAAT;AAIA,QAAMS,YAAY,GAAGb,eAAe,IAAIE,eAAxC;AAEA,QAAMY,QAAQ,GAAGlB,SAAS,CAACmB,UAAV,CAAqBhD,GAAG,CAACiD,QAAzB,CAAjB;AACA,QAAMC,QAAQ,GAAGrB,SAAS,CAACmB,UAAV,CAAqBhD,GAAG,CAACmD,QAAzB,CAAjB;AACA,QAAMC,sBAAsB,GAAGL,QAAQ,CAACM,QAAxC;AACA,QAAMC,sBAAsB,GAAGJ,QAAQ,CAACG,QAAxC;AACA,QAAME,eAAe,GAAGtB,eAAH,aAAGA,eAAH,cAAGA,eAAH,GAAsBmB,sBAA3C;AACA,QAAMI,eAAe,GAAGrB,eAAH,aAAGA,eAAH,cAAGA,eAAH,GAAsBmB,sBAA3C;AACA,QAAMG,SAAS,GAAG3D,YAAY,CAACyD,eAAD,CAAZ,CAA8BG,aAAhD;AACA,QAAMC,SAAS,GAAG7D,YAAY,CAAC0D,eAAD,CAAZ,CAA8BE,aAAhD;AAEA,QAAME,oBAAoB,GAAGR,sBAAsB,KAAKE,sBAA3B,IAC3BP,QAAQ,CAACc,cAAT,KAA4BX,QAAQ,CAACW,cADvC;;AAGA,WAASC,eAAT,GAA2B;AACzB,UAAMC,iBAAiB,GAAG1B,QAAQ,CAAC2B,KAAT,CAAe,CAAf,CAA1B;AACAD,IAAAA,iBAAiB,CAACE,GAAlB;AACA3B,IAAAA,WAAW,CAACyB,iBAAD,CAAX;AACD;;AAED,sBAAO,uDACL,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,iBAAD;AACE,IAAA,MAAM,EAAE,CAACjB,YADX;AAEE,IAAA,OAAO,EAAE,MAAM;AACb,UAAGA,YAAH,EAAiB;AACfJ,QAAAA,uBAAuB,CAAC,IAAD,CAAvB;AACD;AACF,KANH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,eASE,oBAAC,kBAAD;AACE,IAAA,QAAQ,EAAE,CAACkB,oBADb;AAEE,IAAA,OAAO,EAAE,MAAM;AACb,UAAIA,oBAAJ,EAA0B;AACxBpB,QAAAA,qBAAqB,CAAC,IAAD,CAArB;AACD;AACF,KANH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IATF,eAiBE,oBAAC,mBAAD;AACE,IAAA,OAAO,EACL,MAAI,CAAE,CADD,CAEL;AAHJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAjBF,EAwBIe,eAAe,KAAKC,eAApB,gBACA,oBAAC,QAAD;AAAU,IAAA,QAAQ,EAAEC,SAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADA,gBAEA,uDACE,oBAAC,OAAD;AAAS,IAAA,QAAQ,EAAEA,SAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,eAEE,oBAAC,OAAD;AAAS,IAAA,QAAQ,EAAEE,SAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CA1BJ,EAgCIO,MAAM,CAACC,OAAP,CAAetC,SAAS,CAACuC,SAAzB,EAAoCC,GAApC,CAAwC,CAAChB,QAAD,EAAWiB,KAAX,KAAqB;AAC3D,wBACE,oBAAC,WAAD;AACE,MAAA,GAAG,EAAEA,KADP;AAEE,MAAA,EAAE,EAAEjB,QAAQ,CAAC,CAAD,CAFd;AAGE,MAAA,eAAe,EAAEpB,eAAe,KAAKoB,QAAQ,CAAC,CAAD,CAH/C;AAIE,MAAA,eAAe,EAAElB,eAAe,KAAKkB,QAAQ,CAAC,CAAD,CAJ/C;AAKE,MAAA,kBAAkB,EAAEnB,kBALtB;AAME,MAAA,kBAAkB,EAAEE,kBANtB;AAOE,MAAA,gBAAgB,EAAEiB,QAAQ,CAAC,CAAD,CAP5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF;AAWD,GAZD,CAhCJ,EA+CIa,MAAM,CAACC,OAAP,CAAepE,gBAAf,EAAiCsE,GAAjC,CAAqC,CAACE,YAAD,EAAeD,KAAf,KAAyB;AAC5D,wBAAO,oBAAC,YAAD;AACL,MAAA,GAAG,EAAEA,KADA;AAEL,MAAA,EAAE,EAAEC,YAAY,CAAC,CAAD,CAFX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAP;AAID,GALD,CA/CJ,EAuDIlC,QAAQ,CAACgC,GAAT,CAAa,CAACG,OAAD,EAAmBF,KAAnB,KAAqC;AAChD,wBAAO,oBAAC,YAAD;AACL,MAAA,GAAG,EAAEA,KADA;AAEL,MAAA,OAAO,EAAEE,OAFJ;AAGL,MAAA,OAAO,EAAEV,eAHJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAP;AAKD,GAND,CAvDJ,EAgEIvB,kBAAkB,gBAClB,oBAAC,sBAAD;AACE,IAAA,OAAO,EAAE,MAAMC,qBAAqB,CAAC,KAAD,CADtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADkB,gBAGb,yCAnET,EAsEIX,SAAS,CAAC4C,MAAV,KAAqB7E,UAAU,CAAC8E,aAAhC,gBACA,oBAAC,YAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADA,gBACkB,yCAvEtB,EA0EIjC,oBAAoB,gBACpB,oBAAC,gBAAD;AACE,IAAA,eAAe,EAAEc,eADnB;AAEE,IAAA,eAAe,EAAEC,eAFnB;AAGE,IAAA,OAAO,EAAE,MAAM;AACbd,MAAAA,uBAAuB,CAAC,KAAD,CAAvB;AACD,KALH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADoB,gBAOf,yCAjFT,eAoFE,oBAAC,aAAD;AACE,IAAA,OAAO,EAAEb,SAAS,CAACmB,UAAV,CAAqBhD,GAAG,CAACiD,QAAzB,CADX;AAEE,IAAA,OAAO,EAAEpB,SAAS,CAACmB,UAAV,CAAqBhD,GAAG,CAACmD,QAAzB,CAFX;AAGE,IAAA,IAAI,EAAEtB,SAAS,CAACe,IAHlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IApFF,eA0FE,oBAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IA1FF,CADK,CAAP;AA+FD","sourcesContent":["import React, { useState, useLayoutEffect, useEffect } from 'react';\nimport ButtonGroup from './ButtonGroup';\nimport SpaceStation from './SpaceStation'\nimport { GameState, GameStatus, Message } from '../metadata/types';\nimport styled from 'styled-components';\nimport { locationData, spaceStationData } from '../metadata';\nimport * as IDs from '../metadata/agent-ids';\nimport MessageModal from './modal/MessageModal';\nimport { PixelPosition } from '../metadata/types';\nimport ResourcePanel from './ResourcePanel';\nimport RebalanceResourceModal from './modal/RebalanceResourceModal';\nimport EndGameModal from './modal/EndGameModal';\nimport ConfirmMoveModal from './modal/ConfirmMoveModal';\nimport { useSelector } from './redux-hook-adapters';\nimport Clock from './Clock';\n\nconst GEMINI_LEFT_OFFSET = 45;\nconst GEMINI_TOP_OFFSET = 50;\n\nconst GameBoard = styled.div`\n  background-image: url(${`${process.env.PUBLIC_URL}/game_map.jpg`});\n  height: 810px;\n  width: 1440px;\n  background-size: contain;\n  position: relative;\n  margin: 0 auto;\n`;\n\nconst GeminiShip = styled.div`\n  width: 80px;\n  height: 80px;\n  display: block;\n  position: absolute;\n  background-size: contain;\n`;\nconst Gemini1 = styled(GeminiShip)`\n  background-image: url(${`${process.env.PUBLIC_URL}/Gemini1.png`});\n  top: ${(props: { position: PixelPosition }) => `${props.position.top - GEMINI_TOP_OFFSET}px`};\n  left: ${(props: { position: PixelPosition }) => `${props.position.left - GEMINI_LEFT_OFFSET}px`};\n`;\nconst Gemini2 = styled(GeminiShip)`\n  background-image: url(${`${process.env.PUBLIC_URL}/Gemini2.png`});\n  top: ${(props: { position: PixelPosition }) => `${props.position.top - GEMINI_TOP_OFFSET}px`};\n  left: ${(props: { position: PixelPosition }) => `${props.position.left - GEMINI_LEFT_OFFSET}px`};\n`;\nconst Gemini12 = styled(GeminiShip)`\n  background-image: url(${`${process.env.PUBLIC_URL}/Gemini12.png`});\n  top: ${(props: { position: PixelPosition }) => `${props.position.top - GEMINI_TOP_OFFSET}px`};\n  left: ${(props: { position: PixelPosition }) => `${props.position.left - GEMINI_LEFT_OFFSET}px`};\n`;\n\nconst ActionButton = styled.div`\n  width: 120px;\n  height: 40px;\n  position: absolute;\n  background-size: cover;\n  cursor: pointer;\n`;\n\nconst ConfirmMoveButton = styled(ActionButton)`\n  background-image: url(${`${process.env.PUBLIC_URL}/confirm_move.png`});\n  top: 10px;\n  left: 30px;\n  cursor: ${(props: { noMove: Boolean }) => !props.noMove ? 'cursor': `not-allowed`};\n  :hover {\n    background-image: ${(props: { noMove: Boolean }) => props.noMove ? `url(${process.env.PUBLIC_URL}/confirm_move.png)`: `url(${process.env.PUBLIC_URL}/confirm_move_hover.png)`};\n  }\n`;\n\nconst MoveResourceButton = styled(ActionButton)`\n  background-image: url(${`${process.env.PUBLIC_URL}/move_resources.png`});\n  top: 580px;\n  left: 100px;\n  cursor: ${(props: { disabled: Boolean }) => !props.disabled ? 'cursor': `not-allowed`};\n  :hover {\n    background-image: ${(props: { disabled: Boolean }) => !props.disabled ? `url(${process.env.PUBLIC_URL}/move_resources_hover.png)`: `url(${process.env.PUBLIC_URL}/move_resources.png)`};\n  }\n`;\n\nconst TerminateGameButton = styled(ActionButton)`\n  background-image: url(${`${process.env.PUBLIC_URL}/abort_mission.png`});\n  top: 55px;\n  left: 30px;\n  :hover {\n    background-image: url(${`${process.env.PUBLIC_URL}/abort_mission_hover.png`});\n  }\n`;\n\nexport default function() {\n  const gameState = useSelector((state: GameState) => state);\n  console.log(gameState);\n\n  const [gemini1NextMove, setGemini1NextMove] = useState<string | undefined>();\n  const [gemini2NextMove, setGemini2NextMove] = useState<string | undefined>();\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [showRebalanceModal, setShowRebalanceModal] = useState(false);\n  const [showConfirmMoveModal, setShowConfirmMoveModal] = useState(false);\n\n  useLayoutEffect(() => {\n    setGemini1NextMove(undefined);\n    setGemini2NextMove(undefined);\n    if (gameState.time > 30) {\n      // setGameOver(true);\n    }\n  }, [gameState.time]);\n  \n  useEffect(() => {\n    setMessages(messages.concat(gameState.messages));\n  }, [gameState.messages]);\n\n  const selectedMove = gemini1NextMove && gemini2NextMove;\n\n  const gemini_1 = gameState.spaceships[IDs.GEMINI_1];\n  const gemini_2 = gameState.spaceships[IDs.GEMINI_2];\n  const gemini1CurrentLocation = gemini_1.location;\n  const gemini2CurrentLocation = gemini_2.location\n  const gemini1Location = gemini1NextMove ?? gemini1CurrentLocation;\n  const gemini2Location = gemini2NextMove ?? gemini2CurrentLocation;\n  const position1 = locationData[gemini1Location].pixelPosition;\n  const position2 = locationData[gemini2Location].pixelPosition;\n\n  const canRebalanceResource = gemini1CurrentLocation === gemini2CurrentLocation &&\n    gemini_1.isInTimePortal === gemini_2.isInTimePortal;\n\n  function popMessageModal() {\n    const remainingMessages = messages.slice(0);\n    remainingMessages.pop();\n    setMessages(remainingMessages);\n  }\n\n  return <>\n    <GameBoard>\n      <ConfirmMoveButton  \n        noMove={!selectedMove}\n        onClick={() => {\n          if(selectedMove) {\n            setShowConfirmMoveModal(true);\n          }\n        }}\n        ></ConfirmMoveButton>\n      <MoveResourceButton\n        disabled={!canRebalanceResource}\n        onClick={() => {\n          if (canRebalanceResource) {\n            setShowRebalanceModal(true)\n          }\n        }}\n      ></MoveResourceButton>\n      <TerminateGameButton \n        onClick={\n          ()=>{}\n          // () => setGameOver(true)\n        }\n      ></TerminateGameButton>\n      {\n        gemini1Location === gemini2Location ? \n        <Gemini12 position={position1} /> :\n        <>\n          <Gemini1 position={position1} />\n          <Gemini2 position={position2} />\n        </>\n      }\n      {\n        Object.entries(gameState.nextMoves).map((location, index) => {\n          return (\n            <ButtonGroup \n              key={index}\n              id={location[0]}\n              gemini1NextMove={gemini1NextMove === location[0]}\n              gemini2NextMove={gemini2NextMove === location[0]}\n              setGemini1NextMove={setGemini1NextMove}\n              setGemini2NextMove={setGemini2NextMove}\n              shipReachability={location[1]}\n            />\n          );\n        })\n      }\n      {\n        Object.entries(spaceStationData).map((spaceStation, index) => {\n          return <SpaceStation\n            key={index}\n            id={spaceStation[0]}\n          />;\n        })\n      }\n      {\n        messages.map((message: Message, index: number) => {\n          return <MessageModal\n            key={index}\n            message={message}\n            onClose={popMessageModal}\n          />;\n        })\n      }\n      {\n        showRebalanceModal ?\n        <RebalanceResourceModal\n          onClose={() => setShowRebalanceModal(false)}\n        /> : <></>\n      }\n      {\n        gameState.status === GameStatus.MissionFailed ?\n        <EndGameModal/> : <></>\n      }\n      {\n        showConfirmMoveModal ?\n        <ConfirmMoveModal\n          gemini1NextMove={gemini1Location}\n          gemini2NextMove={gemini2Location}\n          onClose={() => {\n            setShowConfirmMoveModal(false)\n          }}\n        /> : <></>\n      }\n\n      <ResourcePanel\n        gemini1={gameState.spaceships[IDs.GEMINI_1]}\n        gemini2={gameState.spaceships[IDs.GEMINI_2]}\n        time={gameState.time}\n      ></ResourcePanel>\n\n      <Clock />\n\n    </GameBoard>\n  </>;\n}\n"]},"metadata":{},"sourceType":"module"}